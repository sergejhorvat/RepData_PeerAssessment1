---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r ,echo = TRUE}
data <- unzip(zipfile = "activity.zip")
activity <- read.csv(data)
activity <- activity[complete.cases(activity),] 
```



## What is mean total number of steps taken per day?
```{r ,echo = TRUE }
head(activity)
activityAgg <- aggregate(activity$steps~activity$date, activity,sum)
hist(x = activityAgg$`activity$steps`)
activityAggMean <- mean(activityAgg$`activity$steps`)
cat("Daily mean steps are: " , activityAggMean )
activityMedian <- median(activityAgg$`activity$steps`)
cat("Daily median steps are: " , activityMedian)
```

## What is the average daily activity pattern?
```{r ,echo = TRUE }
activityInterval <- aggregate(activity$steps~activity$interval,activity,mean)
plot(y=activityInterval$`activity$steps`, 
     x=activityInterval$`activity$interval`,type = "l")
activityIntervalMax <- max(activityInterval$`activity$steps`)

#activityIntervalMaxInterval <- max(activityInterval$`activity$steps`~ activityInterval$`activity$interval`)

# Find the row of maximum steps
maxInterval <- activityInterval[which.max(activityInterval$`activity$steps`),]$`activity$interval`

cat("Maximum number of averaged steps are ", activityIntervalMax , "in interval ", maxInterval)
```


## Imputing missing values

```{r, echo=TRUE}
activityOrg <- read.csv(data)
totalMissing <- sum(is.na(activityOrg$steps))
totalMissing
cat("total number of missing step values from a original dataset is " , totalMissing)

naRows <- which(is.na(activityOrg$steps))

# ovo zamijeniti sa meanom od intervala 
activityOrg[naRows,]$steps

activityOrg[naRows,]$interval


#activityInterval[activityOrg[naRows,]$interval==activityInterval$`activity$interval`,]$`activity$steps`

#activityOrg[naRows,]$interval==activityInterval$`activity$interval`
activityOrgFilled <- activityOrg



# Try to loop for NA and find the interval to replace with
for(i in 1:nrow(activityOrgFilled))
  {
    if (is.na(activityOrgFilled$steps[i])) 
    {
      activityOrgFilled$steps[i] <- activityInterval[activityOrgFilled$interval[i]==activityInterval$`activity$interval`,]$`activity$steps`
    }
}

# Is there any NA fileds in new data frame activityOrgFilled?
naRows2 <- sum(is.na(activityOrgFilled$steps))
cat("With filled in mean intervals there are " , naRows2 , " NA fields")

```

## Are there differences in activity patterns between weekdays and weekends?
